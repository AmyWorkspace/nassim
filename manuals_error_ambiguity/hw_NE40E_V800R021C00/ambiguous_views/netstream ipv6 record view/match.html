
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="match">
<meta name="DC.subject" content="match">
<meta name="keywords" content="match">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/dc_NetStream_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/mask.html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/ip_netstream.html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R21C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20220226">
<meta name="Owner" content="SUBSYS_ID_NSMOM">
<meta name="DC.Creator" content="SUBSYS_ID_NSMOM">
<meta name="Platform" content="8090-V800R021C00">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="hKF77426">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001221896525">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../../public_sys-resources/browseVersion.js"></script>
<title>match</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001221896525"></a><a name="EN-US_CLIREF_0000001221896525"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">match</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001221896525__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">match</span></b> command configures the aggregation keywords of a flexible flow statistics template.</p>
<p>The <b><span class="cmdname">undo match</span></b> command deletes the aggregation keywords of the flexible flow statistics template.</p>
</p>
<p>By default, no aggregation keyword is configured for the flexible flow statistics template.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001221896525__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">match </span></b>{ <strong><span>source</span></strong> | <strong><span>destination</span></strong> } { <strong><span>vlan</span></strong> | <strong><span>as</span></strong> | <strong><span>port</span></strong> | <strong><span>address</span></strong> | <strong><span>mask</span></strong> }</p>

<p><b><span class="cmdname">match mpls top-label ip-address</span></b></p>

<p><b><span class="cmdname">match mpls label </span></b><i><span class="varname">position</span></i></p>

<p><b><span class="cmdname">match </span></b>{ <strong><span>protocol</span></strong> | <strong><span>tos</span></strong> | <strong><span>direction</span></strong> | <strong><span>tcp-flag</span></strong> }</p>

<p><b><span class="cmdname">match </span></b>{ <strong><span>input</span></strong> | <strong><span>output</span></strong> } <strong><span>interface</span></strong></p>

<p><b><span class="cmdname">match next-hop </span></b>[ <strong><span>bgp</span></strong> ]</p>

<p><b><span class="cmdname">undo match </span></b>{ <strong><span>source</span></strong> | <strong><span>destination</span></strong> } { <strong><span>vlan</span></strong> | <strong><span>as</span></strong> | <strong><span>port</span></strong> | <strong><span>address</span></strong> | <strong><span>mask</span></strong> }</p>

<p><b><span class="cmdname">undo match mpls top-label ip-address</span></b></p>

<p><b><span class="cmdname">undo match mpls label </span></b><i><span class="varname">position</span></i></p>

<p><b><span class="cmdname">undo match </span></b>{ <strong><span>protocol</span></strong> | <strong><span>tos</span></strong> | <strong><span>direction</span></strong> | <strong><span>tcp-flag</span></strong> }</p>

<p><b><span class="cmdname">undo match </span></b>{ <strong><span>input</span></strong> | <strong><span>output</span></strong> } <strong><span>interface</span></strong></p>

<p><b><span class="cmdname">undo match next-hop </span></b>[ <strong><span>bgp</span></strong> ]</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001221896525__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>source</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the source end.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>destination</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the destination end.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>vlan</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the VLAN.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>as</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the autonomous system (AS).</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>port</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the port number.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>address</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation prefix-based on the address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>mask</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the mask.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>mpls</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates the multi-protocol label switching.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>top-label</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates the top label.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>ip-address</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the IP address.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>label</span></strong> <i><span class="varname">position</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the MPLS label location based on which aggregation is performed.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 1 to 3.</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>protocol</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the protocol type.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>tos</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the ToS priority.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>direction</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the flow direction.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>tcp-flag</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the tcp-flag.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>input</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the ingress port.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>output</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the egress port.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>interface</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the interface.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>next-hop</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the next hop.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>bgp</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Indicates aggregation based on the BGP protocol.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001221896525__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p>NetStream IPv6 record view., NetStream record view</p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001221896525__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>3: Management level</p>

</div></div>

<div class="clitasknameandoper"><a name="EN-US_CLIREF_0000001221896525__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Task Name and Operations</h2>
<div class="clitasknameandoperbody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.1">Task Name</th>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.2">Operations</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.6.1-type">netstream</td>
<td valign="top" headers="mcps1.3.6.1-value">write</td>
</tr>

</table></div>

</div></div>

<div class="clidesc"><a name="EN-US_CLIREF_0000001221896525__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>NetStream supports 17 aggregation modes. For each aggregation mode, original flows are classified and combined to generate aggregated flow information and are aged and exported to the server based on fixed rules. Flexible customization is not supported. Flexible flow packets provide a user-defined template for users to customize matching fields as required. The user-defined template improves traffic analysis accuracy and reduces network bandwidth occupation, CPU usage, and storage space usage.</p>
<p><strong>Prerequisites</strong></p>
<p>Before you run the match command, run the ip netstream record or ipv6 netstream record command to create a flexible flow statistics template.</p>
<p><strong>Precautions</strong></p>
<p>If a flexible flow has been applied, you are not allowed to run the match command to modify the matching rules.<p></p>
The maximum length that the flexible flow statistics template supports is 50 bytes, including the collect and match fields.<p></p>
Lengths of the match fields:</p>

<ul><li>address: 4 bytes for an IPv4 address and 16 bytes for an IPv6 address</li><li>mask: 1 byte</li><li>port: 2 bytes</li><li>vlan: 2 bytes</li><li>as: 4 bytes</li><li>mpls top-label ip-address: 4 bytes</li><li>mpls label 1: 3 bytes</li><li>mpls label 2: 3 bytes</li><li>mpls label 3: 3 bytes</li><li>potocol: 1 byte</li><li>tos: 1 byte</li><li>direction: 1 byte</li><li>tcp-flag: 1 byte</li><li>input interface: 4 bytes</li><li>output interface: 4 bytes</li><li>next-hop: 4 bytes for an IPv4 address and 16 bytes for an IPv6 address</li><li>bgp next-hop: 4 bytes for an IPv4 address and 16 bytes for an IPv6 address<p></p>
Lengths of the collect fields:</li><li>first: 4 bytes</li><li>last: 4 bytes</li><li>packets: 4 bytes</li><li>bytes: 4 bytes<p></p>
The match source address command indicates aggregation based on the source prefix address. It is the prefix address pool after the source IP address and source mask address are masked.<p></p>
The match destination address command indicates aggregation based on the destination prefix address. It is the prefix address pool after the destination IP address and destination mask address of the traffic are masked.<p></p>
If the obtained mask address is 0, no mask operation is performed. Aggregation is performed based on the IP address.</li></ul>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001221896525__1.3.8"></a><a name="1.3.8"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure matching rules in the flexible flow view.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>ip netstream record tt</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-record-tt] <strong>match source address</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-record-tt] <strong>match source port</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-record-tt] <strong>match protocol</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-record-tt] <strong>match tos</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-record-tt] <strong>match direction</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../command/8090/dc_NetStream_Configuration_Commands_title.html">NetStream Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../command/8090/mask.html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../command/8090/ip_netstream.html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>