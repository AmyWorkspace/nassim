
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="vrrp-backup mac-withdraw retry-interval">
<meta name="DC.subject" content="vrrp-backup mac-withdraw retry-interval">
<meta name="keywords" content="vrrp-backup mac-withdraw retry-interval">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/dc_VPLS_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/bgp-ad-vpn-target(VPLSAD).html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/vsi(VPLSCOMM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R21C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20220226">
<meta name="Owner" content="SUBSYS_ID_VPLSCOMM">
<meta name="DC.Creator" content="SUBSYS_ID_VPLSCOMM">
<meta name="Platform" content="VRP-V800R021C00">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="hKF77426">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001245852047">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../../public_sys-resources/browseVersion.js"></script>
<title>vrrp-backup mac-withdraw retry-interval</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001245852047"></a><a name="EN-US_CLIREF_0000001245852047"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">vrrp-backup mac-withdraw retry-interval</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001245852047__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">vrrp-backup mac-withdraw retry-interval</span></b> command enables a device to resend a MAC-Withdraw message after a specified delay in case that the VRRP status changes to backup.</p>
<p>The <b><span class="cmdname">undo vrrp-backup mac-withdraw retry-interval</span></b> command disables a device from resending a MAC-Withdraw message after a specified delay in case that the VRRP status changes to backup.</p>
</p>
<p>By default, a device does not resend a MAC-Withdraw message in case that the VRRP status changes to backup.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001245852047__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">vrrp-backup mac-withdraw retry-interval </span></b><i><span class="varname">retry-interval-time</span></i></p>

<p><b><span class="cmdname">undo vrrp-backup mac-withdraw retry-interval </span></b><i><span class="varname">retry-interval-time</span></i></p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001245852047__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>retry-interval</span></strong> <i><span class="varname">retry-interval-time</span></i></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies a delay after which a device resends a MAC-Withdraw message.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>The value is an integer ranging from 0 to 60, in seconds.</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001245852047__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p>VSI-AUTO view, VSI-BD view, VSI-BVSI view, VSI-DEFAULT view, VSI-IVSI-BEVPNINTERWORK view, VSI-IVSI-P2P view, VSI-STATIC view</p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001245852047__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>

<div class="clitasknameandoper"><a name="EN-US_CLIREF_0000001245852047__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Task Name and Operations</h2>
<div class="clitasknameandoperbody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.1">Task Name</th>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.2">Operations</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.6.1-type">l2vpn</td>
<td valign="top" headers="mcps1.3.6.1-value">write</td>
</tr>

</table></div>

</div></div>

<div class="clidesc"><a name="EN-US_CLIREF_0000001245852047__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>Figure 1 shows configuring delayed resending of a MAC-Withdraw message in the configuration guide, the CE is dual-homed to PE1 and PE2. VRRP runs on the PEs, with PE1 functioning as the master device and PE2 the backup device. If the link between the CE and PE1 fails, a master/backup VRRP switchover is performed. PE1 becomes the backup device, and PE2 becomes the master device. After the link between the CE and PE1 recovers, a master/backup VRRP switchback is performed if the VRRP backup group works in preemption mode. PE1 returns to the master state, and PE2 to the backup state.<p></p>
Take a master/backup VRRP switchback as an example. When PE2 changes from the master state to the backup state, the PE2 interface connecting to PE3 goes Down and sends a MAC-Withdraw message to PE3 to clear the MAC address entry for PE3. Normally, PE3 no longer receives packets forwarded by PE2. Instead, PE3 receives only upstream packets forwarded by the master device PE1, and records the mapping between the CE's MAC address and PW1. However, during the switchback, the interface's forwarding status table on PE2 is updated slowly. As a result, PE2 still sends a few packets to PE3 after the switchback. Upon receipt, PE3 records the mapping between the CE's MAC address and PW2 again. In this case, PE3 incorrectly sends the downstream packets destined for the CE to PE2 through PW2. As a result, packets are lost, and packet forwarding can recover only after the local MAC address entry ages.<p></p>
To resolve this issue, run the vrrp-backup mac-withdraw retry-interval command on PE1 and PE2. When either PE changes to the backup state, in addition to a MAC-Withdraw message sent to PE3 by default, the PE interface sends a FlowDown message and then another MAC-Withdraw message to PE3 to clear the MAC address entry for PE3. After the specified resending delay elapses, the PE sends another MAC-Withdraw message to PE3 to ensure that PE3 learns the mapping between the CE's MAC address and the primary PW. In this way, PE3 sends downstream packets to the master device to prevent packet loss. After this command is run, a PE sends three MAC-Withdraw messages in total to PE3 after the PE switches to the backup state.</p>
<p><strong>Prerequisites</strong></p>
<p><p>A VSI has been created using the vsi command.</p>
</p>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001245852047__1.3.8"></a><a name="1.3.8"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure a device to resend a MAC-Withdraw message after a delay of 20s in case that the VRRP status changes to backup.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mpls</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-mpls] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>mpls l2vpn</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-l2vpn] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>vsi abc</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-abc] <strong>vrrp-backup mac-withdraw retry-interval 20</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../command/8090/dc_VPLS_Configuration_Commands_title.html">VPLS Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../command/8090/bgp-ad-vpn-target(VPLSAD).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../command/8090/vsi(VPLSCOMM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>