
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en-us" xml:lang="en-us">
<head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="DC.Type" content="cliref">
<meta name="DC.Title" content="mac-learn-style">
<meta name="DC.subject" content="mac-learn-style">
<meta name="keywords" content="mac-learn-style">
<meta name="product" content="">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/dc_VPLS_Configuration_Commands_title.html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/vsi-mac-address-aging-time(VPLSCOMM).html">
<meta name="DC.Relation" scheme="URI" content="../../command/8090/vsi-mac-learning(VPLSCOMM).html">
<meta name="prodname" content="">
<meta name="version" content="">
<meta name="brand" content="Product Documentation-V8R21C00">
<meta name="DC.Creator" content="">
<meta name="DC.Publisher" content="20220226">
<meta name="Owner" content="SUBSYS_ID_VPLSCOMM">
<meta name="DC.Creator" content="SUBSYS_ID_VPLSCOMM">
<meta name="Platform" content="VRP-V800R021C00">
<meta name="IA" content="">
<meta name="SE" content="">
<meta name="TE" content="">
<meta name="LASTMODIFIER" content="hKF77426">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="EN-US_CLIREF_0000001246212013">
<meta name="DC.Language" content="en-us">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/commonltr.css">
<link rel="stylesheet" type="text/css" href="../../public_sys-resources/mediaQuery.css">
<script language="javascript" type="text/javascript" src="../../public_sys-resources/browseVersion.js"></script>
<title>mac-learn-style</title>

<style type="text/css">
			<!--	pre.screen,pre.codeblock{
					word-wrap:break-word;
					word-break:break-all;
					white-space:pre-wrap !important;
				}-->
		</style>
</head>
<body><a name="EN-US_CLIREF_0000001246212013"></a><a name="EN-US_CLIREF_0000001246212013"></a>

<div class="articleBoxWithoutHead">

<h1 class="topicTitle-h1">mac-learn-style</h1>


<div>
<div class="clifunc"><a name="EN-US_CLIREF_0000001246212013__1.3.1"></a><a name="1.3.1"></a><h2 class="sectiontitle">Function</h2>
<div class="clifuncbody">
<p><p>The <b><span class="cmdname">mac-learn-style</span></b> command configures the MAC address learning mode of a VSI.</p>
<p>The <b><span class="cmdname">undo mac-learn-style qualify</span></b> command restores the default MAC address learning mode of a VSI.</p>
</p>
<p>By default, the MAC address learning mode is unqualify.</p>

</div></div>

<div class="cliformat"><a name="EN-US_CLIREF_0000001246212013__1.3.2"></a><a name="1.3.2"></a><h2 class="sectiontitle">Format</h2>
<div class="cliformatbody">
<p><b><span class="cmdname">mac-learn-style </span></b>{ <strong><span>qualify</span></strong> | <strong><span>unqualify</span></strong> }</p>

<p><b><span class="cmdname">mac-learn-style qualify </span></b>{ <strong><span>outer-vlan</span></strong> | <strong><span>inner-vlan</span></strong> }</p>

<p><b><span class="cmdname">undo mac-learn-style qualify</span></b></p>

<p><b><span class="cmdname">undo mac-learn-style qualify </span></b>{ <strong><span>outer-vlan</span></strong> | <strong><span>inner-vlan</span></strong> }</p>

</div></div>

<div class="cliparam"><a name="EN-US_CLIREF_0000001246212013__1.3.3"></a><a name="1.3.3"></a><h2 class="sectiontitle">Parameters</h2>
<div class="cliparambody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.1">Parameter</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.2">Description</th>
<th valign="bottom" align="left" id="mcps1.3.3.1.1.3">Value</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>qualify</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the MAC address learning mode as qualify.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>unqualify</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>Specifies the MAC address learning mode as unqualify.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>outer-vlan</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>The VSI uses the outer VLAN ID to learn MAC addresses.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

<tr>
<td valign="top" headers="mcps1.3.3.1-type"><strong><span>inner-vlan</span></strong></td>
<td valign="top" headers="mcps1.3.3.1-desc">
<p><p>The VSI uses the inner VLAN ID to learn MAC addresses.</p>
</p>

</td>
<td valign="top" headers="mcps1.3.3.1-value"><p>-</p>
</td>
</tr>

</table></div>

</div></div>

<div class="cliview"><a name="EN-US_CLIREF_0000001246212013__1.3.4"></a><a name="1.3.4"></a><h2 class="sectiontitle">Views</h2>
<div class="cliviewbody">
<p>VSI-AUTO view, VSI-DEFAULT view, VSI-STATIC view</p>

</div></div>

<div class="clidefaultlevel"><a name="EN-US_CLIREF_0000001246212013__1.3.5"></a><a name="1.3.5"></a><h2 class="sectiontitle">Default Level</h2>
<div class="clidefaultlevelbody">
<p>2: Configuration level</p>

</div></div>

<div class="clitasknameandoper"><a name="EN-US_CLIREF_0000001246212013__1.3.6"></a><a name="1.3.6"></a><h2 class="sectiontitle">Task Name and Operations</h2>
<div class="clitasknameandoperbody">
<div class="tableBorder"><table cellpadding="4" cellspacing="0" summary="">
<tr>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.1">Task Name</th>
<th valign="bottom" align="left" id="mcps1.3.6.1.1.2">Operations</th>
</tr>
<tr>
<td valign="top" headers="mcps1.3.6.1-type">l2vpn</td>
<td valign="top" headers="mcps1.3.6.1-value">write</td>
</tr>

</table></div>

</div></div>

<div class="clidesc"><a name="EN-US_CLIREF_0000001246212013__1.3.7"></a><a name="1.3.7"></a><h2 class="sectiontitle">Usage Guidelines</h2>
<div class="clidescbody">
<p><strong>Usage Scenario</strong></p>
<p>A characteristic of the Ethernet service is that broadcast, multicast, and unknown unicast frames are flooded to all interfaces. This characteristic is called flooding. To achieve flooding within the service provider network, Ethernet-based VPLS floods all unknown unicast, broadcast, and multicast frames over the corresponding PWs to all PEs participating in the VPLS, as well as to all ACs. However, multicast frames do not necessarily have to be sent to all VPN members. To prevent unnecessary multicast frame forwarding, a PE must be able to associate a destination MAC address with a PW. Since it is impossible to require that PEs statically associate every possible destination MAC address with a PW, VPLS-capable PEs must have the capability to dynamically learn MAC addresses from both ACs and PWs. To configure the MAC address learning mode of a VSI, run the mac-learn-style command. In this command, either of the following parameters can be configured:</p>

<ul><li>qualify: In qualified learning, each customer VLAN has its own broadcast domain and MAC address space. A PE learns both the MAC addresses and VLAN tags of received frames.</li><li>unqualify: In unqualified learning, all the VLANs of a single customer are handled by a single VPLS service, which means they all share a single broadcast domain and a single MAC address space. The MAC addresses need to be unique and non-overlapping among customer VLANs. A PE learns only the MAC addresses of received frames.</li></ul>
<p><strong>Prerequisites</strong></p>
<p><p>A VSI has been created or the VSI view is displayed using the vsi command.</p>
</p>
<p><strong>Precautions</strong></p>
<div class="p"><p>As the MAC leaning style mode of a VSI does not support E2E negotiation, the E2E configuration must be consistent. If a configuration inconsistency occurs, the VLAN-based MAC address learning may be incorrect or packets may be discarded.<p></p>
In an HVPLS scenario, it is recommended that MAC address learning in qualified mode be disabled on SPEs. To enable this function, ensure that the types of interfaces connected to the PEs at both ends are the same. The types of interfaces connected to the PEs can be dot1q VLAN tag termination sub-interfaces, QinQ mapping sub-interfaces, or QinQ stacking sub-interfaces.<p></p>
When the qualified mode is configured on an SPE, the type of VLAN tag used for MAC address learning must be specified:</p>

<ul><li>outer-vlan: learns MAC addresses based on outer VLAN tags.</li><li>inner-vlan: learns MAC addresses based on inner VLAN tags.<p></p>
In an HVPLS scenario, after a dot1q VLAN tag termination sub-interface is bound to a remote PE, the mac-learn-style qualify outer-vlan command needs to be run to enable MAC address learning in qualified mode on an SPE. After a QinQ mapping or QinQ stacking sub-interface is bound to a remote PE, you can run the mac-learn-style qualify inner-vlan or mac-learn-style qualify command to enable MAC address learning in qualified mode on an SPE.<p></p>
After the mac-learn-style qualify command is run for a VSI, only a dot1q VLAN tag termination sub-interface, QinQ mapping sub-interface, or QinQ stacking sub-interface can be bound to the VSI. If outer-vlan is specified, only a dot1q VLAN tag termination sub-interface can be bound to the VSI. If inner-vlan is specified, only a QinQ mapping or QinQ stacking sub-interface can be bound to the VSI.<p></p>
After a dot1q VLAN tag termination sub-interface is bound to a VSI, MAC address learning in qualify mode cannot be configured. Therefore, you need to run the mac-learn-style qualify command before binding the sub-interface to a VSI. After a dot1q VLAN tag termination sub-interface is bound to a VSI, MAC address learning in qualify mode cannot be disabled. To restore the default MAC address learning mode of the VSI, unbind the dot1q VLAN tag termination sub-interface from the VSI first.</li></ul>
</div>

</div></div>

<div class="cliexample"><a name="EN-US_CLIREF_0000001246212013__1.3.8"></a><a name="1.3.8"></a><h2 class="sectiontitle">Example</h2>
<div class="cliexamplebody">

<div class="p"># Configure the MAC address learning mode of the VSI instance as qualify.<pre class="screen">&lt;<span class="keyword">HUAWEI</span>&gt; <strong>system-view</strong>
[<span class="keyword"><font style="font-size:8pt" Face="Courier New" >~</font></span><span class="keyword">HUAWEI</span>] <strong>mpls</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-mpls] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>mpls l2vpn</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-l2vpn] <strong>quit</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>] <strong>vsi vsi1</strong>
[<span class="keyword">*</span><span class="keyword">HUAWEI</span>-vsi-vsi1] <strong>mac-learn-style qualify</strong>
</pre>
</div>

</div></div>

</div>


</div>
<div class="footerNavBar clearfix">

<div class="parentlink">
Parent Topic:
<a href="../../command/8090/dc_VPLS_Configuration_Commands_title.html">VPLS Configuration Commands
</a>
</div>
<div class="copyrightBottomBar">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="copyrightBottomBar_responsive">
Copyright &copy; Huawei Technologies Co., Ltd.</div>
<div class="bottomNavBtn clearfix">
<a href="../../command/8090/vsi-mac-address-aging-time(VPLSCOMM).html"><span class="font-st">&lt; </span>Previous topic</a>
<a href="../../command/8090/vsi-mac-learning(VPLSCOMM).html">Next topic<span class="font-st"> &gt;</span></a>
</div>
</div>
</body>
</html>