{
    "PageTitle": "nat reverse-session-limit (NAT policy View)",
    "FuncDef": "The nat reverse-session-limit command sets the maximum number of network-to-user sessions of a specific or all three IP protocols.\nThe undo nat reverse-session-limit command restores the default maximum numbers.\n\nBy default, the maximum number of network-to-user IP sessions for each user of a specific or all three protocols is as follows:\n\n\nTCP or UDP: 10240\n\nICMP: 512\n\nSummation of TCP, UDP and ICMP: 8192. If the maximum number of NAT sessions of all protocols is set, this setting takes preference over the setting for a specific type protocol.",
    "CLIs": [
        "nat reverse-session-limit { tcp | udp | icmp | total } <session-number>",
        "undo nat reverse-session-limit { tcp | udp | icmp | total } [ <session-number> ]"
    ],
    "ParentView": [
        "NAT policy View"
    ],
    "ParaDef": [
        {
            "Parameters": "tcp",
            "Info": "Sets the maximum number of TCP reverse sessions.\n-"
        },
        {
            "Parameters": "udp",
            "Info": "Sets the maximum number of UDP reverse sessions.\n-"
        },
        {
            "Parameters": "icmp",
            "Info": "Sets the maximum number of ICMP reverse sessions.\n-"
        },
        {
            "Parameters": "total",
            "Info": "Sets the maximum number of total reverse sessions.\nIf the total number of TCP, UDP, and ICMP reverse sessions used for NAT has exceeded the maximum, NAT cannot be performed even if the number of TCP, UDP, or ICMP reverse sessions used for NAT has not reached the maximum.\n-"
        },
        {
            "Parameters": "session-number",
            "Info": "Specifies a threshold for the number of reverse sessions.\nThe value of this parameter ranges from 50 to 65535."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] nat-policy template template1",
            "[*HUAWEI-nat-policy-template1] nat reverse-session-limit tcp 20000"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nReverse sessions refer to sessions from network-side devices to user-side devices. Some unauthorized users may consume a lot of session resources to attack devices. As a result, there is a possibility that no session can be used by authorized users for NAT. To prevent this, run the nat reverse-session-limit command to limit the number of sessions that can be used by a CPE.\nConfiguration Impact\nWhen the number of NAT reverse sessions of a user reaches the higher threshold, additional sessions cannot be established. New sessions can be established only when the number of NAT reverse sessions falls below the threshold.\nPrecautions\nThe nat session-limit command can take effect on a NAT template only after the nat session-limit enable command is run in the NAT instance view.\nThe nat reverse-session-limit command only takes effect on VSUF-80/VSUF-160/VSUI-160-E/VSUI-400/VSUI-400-E/VSUI-400A/VSUI-400A-E/VSUI-400-S/VSUI-400A-S, NAT and DS-Lite.\nThis command is supported only on the admin VS."
}