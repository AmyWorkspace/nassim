{
    "PageTitle": "tiebreaker ldp-sync hold-max-cost",
    "FuncDef": "The tiebreaker ldp-sync hold-max-cost command sets the solution of selecting a backup path for OSPF IP FRR to Maximum-cost (set by LDP-IGP synchronization) path first.\nThe undo tiebreaker ldp-sync hold-max-cost command restores the default solution of selecting a backup path for OSPF IP FRR.\nThe tiebreaker ldp-sync hold-max-cost command sets the solution of selecting a backup path for OSPFv3 IP FRR to Maximum-cost (set by LDP-IGP synchronization) path first.\nThe undo tiebreaker ldp-sync hold-max-cost command restores the default solution of selecting a backup path for OSPFv3 IP FRR.\n\nBy default, the solution of selecting a backup path for OSPF IP FRR is node-protection path first.\n\n\nBy default, the solution of selecting a backup path for OSPFv3 IP FRR is node-protection path first.",
    "CLIs": [
        "tiebreaker ldp-sync hold-max-cost preference <preference>",
        "undo tiebreaker ldp-sync hold-max-cost [ preference <preference> ]"
    ],
    "ParentView": [
        "OSPF FRR view"
    ],
    "ParaDef": [
        {
            "Parameters": "preference preference",
            "Info": "Specifies a priority for the solution. The larger the value, the higher the priority.\nThe value is an integer ranging from 1 to 255.\nBy default, the priority of the node-protection path first solution is 40, the priority of the smallest-cost path first solution is 20, and the priority of the maximum-cost (set by LDP-IGP synchronization) path first solution is 10."
        },
        {
            "Parameters": "hold-max-cost",
            "Info": "Sets the solution of selecting a backup path for OSPF IP FRR to maximum-cost (set by LDP-IGP synchronization) path first.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] ospf 1",
            "[*HUAWEI-ospf-1] frr",
            "[*HUAWEI-ospf-1-frr] loop-free-alternate",
            "[*HUAWEI-ospf-1-frr] tiebreaker ldp-sync hold-max-cost preference 255"
        ],
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] ospfv3 1",
            "[*HUAWEI-ospfv3-1] frr",
            "[*HUAWEI-ospfv3-1-frr] loop-free-alternate",
            "[*HUAWEI-ospfv3-1-frr] tiebreaker ldp-sync hold-max-cost preference 255"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nMaximum-cost (set by LDP-IGP synchronization) path first solution shows an inter-board scenario, Figure 2 Maximum-cost (set by LDP-IGP synchronization) path first solution in the Configuration Guide-Enabling OSPF IP FRR, where Link-1 (Device A -> Device D) is the primary path, and Link-2 (Device A -> Device E -> Device D) is the backup path. If Link-1 fails, Link-2 functions as the new primary path, and Link-3 (Device A-> Device B-> Device C-> Device D) functions as the new backup path. If Link-1 goes Up again but the LDP session has not gone Up, OSPF enters the Hold-max-cost state. Consequently, the primary path is still Link-2, and the backup path is still Link-3. If the LDP session goes Up but ldp-sync hold-max-cost is not configured, OSPF exits from the Hold-max-cost state when the timer used to delay sending an LDP session Up message expires. In this case, OSPF switches the primary path back to Link-1. Because the upstream and downstream entries reside on different boards and the downstream entry has not been updated when downstream traffic arrives, packet loss occurs. To resolve the problem, configure ldp-sync hold-max-cost so that OSPF preferentially selects the path with the maximum cost set by LDP-IGP synchronization when OSPF is in the Hold-max-cost state. Then OSPF switches the backup path to Link-1 and delivers the backup forwarding entry in advance. When the timer used to delay sending an LDP session Up message expires, OSPF exits from the Hold-max-cost state and switches the primary path to Link-1. Because the downstream backup entry is available, no packet loss occurs.\nPrerequisites\nThe OSPF FRR view has been displayed using the frr command, and OSPF IP FRR has been enabled using the loop-free-alternate command.\nThe OSPFv3 FRR view has been displayed using the frr command, and OSPFv3 IP FRR has been enabled using the loop-free-alternate command.\nPrecautions\nIf ldp-sync hold-max-cost is configured, you need to run the maximum-link-cost command to change the maximum link cost to a value smaller than 65535."
}