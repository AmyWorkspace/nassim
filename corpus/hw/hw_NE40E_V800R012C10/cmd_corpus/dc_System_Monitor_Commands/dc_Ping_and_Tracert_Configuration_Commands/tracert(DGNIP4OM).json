{
    "PageTitle": "tracert",
    "FuncDef": "The tracert command enables the system to trace the gateways that packets pass through from the source to the destination.",
    "CLIs": [
        "tracert [ -a <source-ip-address> | -f <initTtl> | -m <maxTtl> | -p <destPort> | -q <nqueries> | { -vpn-instance <vpn-instance-name> | -as } | -w <timeout> | -v | -s <size> | -i { <interface-name> | <interface-type> <interface-number> } | -name | { -tos <tos-value> | -dscp <dscp> } | -nexthop <nexthop-address> | -passroute ] * <host>",
        "tracert [ -a <source-ip-address> | -f <initTtl> | -m <maxTtl> | -p <destPort> | -q <nqueries> | { -vpn-instance <vpn-instance-name> [ peer <peerIpv6> ] } | -w <timeout> | -v | -s <size> | -i { <interface-name> | <interface-type> <interface-number> } | -name | { -tos <tos-value> | -dscp <dscp> } | -nexthop <nexthop-address> | -passroute ] * <host>"
    ],
    "ParentView": [
        "All views"
    ],
    "ParaDef": [
        {
            "Parameters": "-a source-ip-address",
            "Info": "Specifies the source address of trace packets. The source IP address is the IP address of the local interface.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "-f initTtl",
            "Info": "Specifies the initial time to live (TTL).\nCarried in the IP header, the TTL field indicates the lifetime of the IP packet and specifies the maximum number of routers that the packet can pass through. The TTL value is set on the source and reduced by 1 each time the packet passes through one router. When the TTL value is reduced to 0, the packet is discarded. At the same time, an ICMP Timeout packet is sent to the source.\nIf initTtl is specified and the number of hops is smaller than the specified value, the TTL value will be greater than 0 after the packet passes through all the nodes. Therefore, no ICMP timeout packet is sent to the source. If maxTtl is specified, the value of initTtl must be smaller than the value of maxTtl.\nThe value is an integer ranging from 1 to 255. The default value is 1."
        },
        {
            "Parameters": "-m maxTtl",
            "Info": "Specifies the maximum TTL.\nGenerally, the maximum TTL is set to the number of hops the packet passes through. You need to use this parameter to change the TTL. If initTtl is specified, the value of maxTtl must be greater than the value of initTtl.\nThe value is an integer ranging from 1 to 255. The default value is 30."
        },
        {
            "Parameters": "-p destPort",
            "Info": "Specifies the UDP port number of the destination.\nIf no UDP port number is specified, when you run the tracert command, a port with the port number greater than 32768 is randomly chosen for the destination to receive trace packets.Before specifying the UDP port number for the destination, ensure that the port is not in use; otherwise, the trace test fails.\nThe value is an integer ranging from 0 to 65535. The default value is 33434."
        },
        {
            "Parameters": "-q nqueries",
            "Info": "Specifies the number of test packets sent in a trace test.\nIn the case of poor network qualities, you can set this parameter to a comparatively larger value to ensure that a test packet can reach the destination.\nThe value is an integer ranging from 1 to 65535. The default value is 3."
        },
        {
            "Parameters": "-vpn-instance vpn-instance-name",
            "Info": "Specifies the name of the VPN instance to which the destination address belongs.\nThe value is a string of 1 to 31 case-sensitive characters, spaces not supported. In addition, the VPN instance name must not be _public_. When double quotation marks are used around the string, spaces are allowed in the string."
        },
        {
            "Parameters": "-as",
            "Info": "Displays the AS number for each hop.\nIf the -as keyword is configured, the AS number of each hop is obtained by querying the local routing table based on the response address. The AS number is displayed only when the corresponding routing entry is learned through BGP and the BGP route carries the AS number.\n-"
        },
        {
            "Parameters": "-w timeout",
            "Info": "Specifies the period of time for waiting for a response.\nIf a test packet reaches a gateway and times out, \"*\" is displayed.\nIn the case of poor network qualities and a low network transmission rate, you are advised to prolong the timeout period.\nThe value is an integer ranging from 0 to 3600000, in milliseconds. The default value is 5000."
        },
        {
            "Parameters": "-v",
            "Info": "Displays the verbose information, including the MPLS label information.\n-"
        },
        {
            "Parameters": "-s size",
            "Info": "Specifies the packet size.\nIt is an integer ranging from 12 to 9600."
        },
        {
            "Parameters": "-i interface-name",
            "Info": "Specifies the name of an interface that sending UDP messages.\n-"
        },
        {
            "Parameters": "interface-type",
            "Info": "Specifies the type of an interface that sending UDP messages.\n-"
        },
        {
            "Parameters": "interface-number",
            "Info": "Specifies the number of an interface that sending UDP messages.\n-"
        },
        {
            "Parameters": "-name",
            "Info": "Displays the host name of the destination address.\n-"
        },
        {
            "Parameters": "-tos tos-value",
            "Info": "Specifies the ToS value of packets sent. By specifying this parameter, you can set the DSCP value and IP priority for packets.\nThe value is an integer ranging from 0 to 255. The default value is 0."
        },
        {
            "Parameters": "-dscp dscp",
            "Info": "Specifies the DSCP value of an Echo Request packet to be sent.\nThe value is an integer ranging from 0 to 63. The default value is 0."
        },
        {
            "Parameters": "-nexthop nexthop-address",
            "Info": "Specifies an IP address for the next hop.\nIf you have specified this parameter, the device no longer searches the routing table before sending UDP packets.\nThe value is in dotted decimal notation.\nThe specified next hop address must be the next hop address of a directly connected physical interface.When you specify a next hop address, you can configure -i interface-type interface-number to specify an outbound interface. The following conditions must be met to ensure a test success:The specified next hop address must match the outbound interface.The specified outbound interface cannot be a logical interface's member interface.If you have specified a next hop address, you cannot specify a VPN."
        },
        {
            "Parameters": "-passroute",
            "Info": "Sends UDP packets without searching for the routing table.\nIf you specify -passroute, specify -nexthop nexthop-address and -i interface-type interface-number at the same time. Otherwise, the test fails.\n-"
        },
        {
            "Parameters": "host",
            "Info": "Specifies the name or the IP address of the destination host.\nThe value is a string of 1 to 255 characters.\nIf the parameter value is an IP address, set the format of the parameter to dotted decimal notation."
        },
        {
            "Parameters": "peer peerIpv6",
            "Info": "Specifies a peer SID, that is, the address of the last hop in the SRv6 domain, in EVPN L3VPN over SRv6 BE scenarios.\nThe value is a 32-digit hexadecimal number, in the format of X:X:X:X:X:X:X:X."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> tracert -q 5 -w 8000 10.10.0.10",
            "traceroute to 10.10.0.10 (10.10.0.10), hops max: 18, packet length: 40,press CTRL_C to break",
            "1 10.3.112.1 (10.3.112.1) 17 ms 17 ms 27 ms 17ms 20ms",
            "2 10.32.216.1 (10.32.216.1) 19 ms 19 ms 19 ms 19ms 18ms",
            "3 10.32.216.1 (10.32.216.1) 39 ms 19 ms 19 ms 25ms 19ms",
            "4 10.32.136.23 (10.32.136.23) 19 ms 39 ms 39 ms 21ms 28ms",
            "5 10.32.168.22 (10.32.168.22) 20 ms 39 ms 39 ms 27ms 30ms",
            "6 10.32.197.4 (10.32.197.4) 59 ms 119 ms 39 ms 60ms 57ms",
            "7 10.119.2.5 (10.119.2.5) 59 ms 59 ms 39 ms 60ms 45ms",
            "8 10.140.70.13 (10.140.70.13) 80 ms 79 ms 99 ms 90ms 87ms",
            "9 10.140.71.6 (10.140.71.6) 139 ms 139 ms 159 ms 120ms 160ms",
            "10 10.140.81.7 (10.140.81.7) 199 ms 180 ms 300 ms 200ms 150ms",
            "11 10.140.72.17 (10.140.72.17) 300 ms 239 ms 239 ms 350ms 200ms",
            "12 * * * * *",
            "13 10.121.54.72 (10.121.54.72) 259 ms 499 ms 279 ms 500ms 550ms",
            "14 * * * * *",
            "15 * * * * *",
            "16 * * * * *",
            "17 * * * * *",
            "18 10.10.0.10 (10.10.0.10) 339 ms 279 ms 279 ms 600ms 592ms"
        ],
        [
            "<HUAWEI> tracert -name -f 2 -m 64 -s 100 10.10.1.1",
            "traceroute to 10.10.1.1(tcore1.as1.net), hops max: 64, packet length: 100,press CTRL_C to break",
            "1 10.1.1.1 (tcore1.as6.net) 19 ms 23 ms 20 ms",
            "2 10.1.2.1 (tcore1.as6453.net) 19 ms 25 ms 30 ms",
            "3 * * *",
            "4 10.1.3.1 (tcore1.as63454.net) 259 ms 499 ms 279 ms",
            "5 * * *",
            "6 10.10.1.1 (tcore1.as1.net) 339 ms 279 ms 279 ms"
        ],
        [
            "<HUAWEI> tracert -vpn-instance abc 192.168.5.115",
            "traceroute to 192.168.5.115 (192.168.5.115), hops max: 30, packet length: 40",
            "1 10.3.112.1    (10.3.112.1)    17 ms  17 ms  27 ms",
            "2 10.32.216.1   (10.32.216.1)   19 ms  19 ms  19 ms",
            "3 * * *",
            "4 10.121.54.72  (10.121.54.72)  259 ms 499 ms 279 ms",
            "5 * * *",
            "6 192.168.5.115 (192.168.5.115) 339 ms 279 ms 279 ms"
        ],
        [
            "<HUAWEI> tracert www.huawei.com",
            "traceroute to 192.168.10.2(www.huawei.com), max hops: 30 ,packet length: 40,press CTRL_C to break",
            " 1 192.168.10.2 7 ms  2 ms  12 ms"
        ],
        [
            "<HUAWEI> tracert -name 192.168.10.2",
            "traceroute to 192.168.10.2(www.huawei.com), max hops: 30 ,packet length: 40,press CTRL_C to break",
            " 1 192.168.10.2(www.huawei.com) 9 ms  1 ms  15 ms"
        ],
        [
            "<HUAWEI> tracert -v 192.168.3.9",
            " traceroute to 192.168.3.9(192.168.3.9), max hops: 30 ,packet length: 40,press CTRL_C to break",
            " 1 10.1.1.2[MPLS Label=4187 Exp=0 S=1 TTL=1] 5 ms  1 ms  1 ms ",
            " 2 10.2.1.2 9 ms  2 ms  2 ms"
        ],
        [
            "<HUAWEI> tracert -vpn-instance abc 192.168.5.115",
            "traceroute to 192.168.5.115 (192.168.5.115), hops max: 30, packet length: 40,press CTRL_C to break",
            "1 10.3.112.1 (10.3.112.1) 17 ms 17 ms 27 ms",
            "2 10.32.216.1 (10.32.216.1) 19 ms 19 ms 19 ms",
            "3 * * *",
            "4 10.121.54.72 (10.121.54.72) 259 ms 499 ms 279 ms",
            "5 * * *",
            "6 192.168.5.115 (192.168.5.115) 339 ms 279 ms 279 ms"
        ],
        [
            "<HUAWEI> tracert -name -f 2 -m 64 -s 100 10.10.1.1",
            "traceroute to 10.10.1.1(tcore1.as1.net), hops max: 64, packet length: 100,press CTRL_C to break",
            "1 10.1.1.1 (tcore1.as6.net) 19 ms 23 ms 20 ms",
            "2 10.1.2.1 (tcore1.as6453.net) 19 ms 25 ms 30 ms",
            "3 * * *",
            "4 10.1.3.1 (tcore1.as63454.net) 259 ms 499 ms 279 ms",
            "5 * * *",
            "6 10.10.1.1 (tcore1.as1.net) 339 ms 279 ms 279 ms"
        ],
        [
            "<HUAWEI> tracer -as 10.4.4.4",
            " traceroute to 10.4.4.4(10.4.4.4), max hops: 30, packet length: 40, press CTRL_C to break",
            " 1 10.1.1.2 5 ms  2 ms  2 ms ",
            " 2 10.3.1.2<AS=300> 5 ms  3 ms  3 ms ",
            " 3 10.4.4.4<AS=400> 5 ms  3 ms  3 ms"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nThe ping command is used to check the connectivity of the network, and the tracert command is used to locate the faulty node.\nIn different test scenarios, parameters specified in the tracert command are different:\nTo view information about nodes between the source and the destination, run the tracert host command.To view information about nodes between the source and the destination on a network of poor qualities, run the tracert -q nqueries -w timeout host command. In the case of an unreliable network, you are advised to set -q and -w to larger values so as to obtain accurate information.To detect the nodes along a certain segment of a path, run the tracert -f initTtl -m maxTtl host command with the specified initial TTL and the maximum TTL.To view information about nodes between the source and the destination on an L3VPN, run the tracert -vpn-instance vpn-instance-name host command. Devices on the L3VPN may not have each other's routing information, and therefore the tracert host command cannot be used to check whether the peer is reachable. In this case, you can run the tracert -vpn-instance vpn-instance-name host command to view information about nodes between the source and the destination in a specified VPN instance.To view information about nodes between the source and the destination host based on packet forwarding without searching for the routing table, run the tracert -nexthop nexthop-address -passroute -i interface-type interface-number command with specified next-hop address and packet outbound interface.\n\nPrerequisites\nBefore running the tracert command, ensure that the UDP module of each node works properly.If vpn-instance is configured, ensure that the VPN module of each node works properly.Ensure that the ICMP module of each node works properly; otherwise, a time out packet will be sent to the source.\n\nImplementation Procedure\nThe process of the tracert command is as follows:\nThe source sends a packet with the TTL being 1. After the TTL times out, the first hop sends an ICMP Error packet to the source, indicating that the packet cannot be forwarded.The source sends a packet with the TTL being 2. After the TTL times out, the second hop sends an ICMP Error packet to the source, indicating that the packet cannot be forwarded.The source sends a packet with the TTL being 3. After the TTL times out, the third hop sends an ICMP Error packet to the source, indicating that the packet cannot be forwarded.The preceding process proceeds until a packet reaches the destination.\nWhen receiving a packet, each destination hop tries to find the port specified in the packet. If no such a port is found, the destination hop sends back an ICMP Port Unreachable packet, indicating that the destination port is unreachable and the trace test ends. Based on the ICMP Port Unreachable packet sent from each hop, you can obtain the path from the source to the destination.\n\nPrecautions\nYou can configure -r for either the tracert command or the ping command to view information about nodes between the source and the destination. Differences between the two commands are as follows:\nIf the ping command times out on an intermediate node, a timeout packet carrying no path information is returned.If the tracert command times out on an intermediate node, the command output shows timeout on this node and the trace test is not interrupted.\nIn the command output, the IP address carried in the tracert response packet is the smallest IP address within the VPN, but not the IP address of the inbound interface."
}