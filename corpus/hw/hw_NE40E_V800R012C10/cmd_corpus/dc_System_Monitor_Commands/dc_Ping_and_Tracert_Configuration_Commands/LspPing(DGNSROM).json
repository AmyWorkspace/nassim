{
    "PageTitle": "ping lsp (All views)",
    "FuncDef": "The ping lsp command tests whether the LSP connectivity and LSP forwarding are normal.",
    "CLIs": [
        "ping lsp [ -a <source-ip> | -c <count> | -exp <exp-value> | -h <ttl-value> | -m <interval> | -s <packet-size> | -t <time-out> | -v | -g ] * segment-routing ip <destination-iphost> <mask-length> [ version draft2 ] [ remote-fec { ldp <remoteipaddr> <remotemasklen> | nil } ]",
        "ping lsp [ -a <source-ip> | -c <count> | -exp <exp-value> | -h <ttl-value> | -m <interval> | -s <packet-size> | -t <time-out> | -v | -g ] * sr-te policy { policy-name <policyname> | endpoint-ip <endpoint-ip> color <colorid> | binding-sid <bsid> }",
        "ping lsp [ -a <source-ip> | -c <count> | -exp <exp-value> | -h <ttl-value> | -m <interval> | -s <packet-size> | -t <time-out> | -v | -g ] * segment-routing ip <destination-iphost> <mask-length> [ version draft2 ] [ remote <remote-ip> ]"
    ],
    "ParentView": [
        "All views"
    ],
    "ParaDef": [
        {
            "Parameters": "-a source-ip",
            "Info": "Specifies the source address of an MPLS Echo Request packet to be sent.\nIf no source address is specified, the MPLS LSR-ID through which an MPLS Echo Request packet is sent will be used.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "-c count",
            "Info": "Specifies the number of times an MPLS Echo Request packet will be sent.\nIn the case of a poor network quality, you can set this parameter to a comparatively large value to test the network quality based on the packet loss percentage.\nThe value is an integer ranging from 1 to 4294967295. The default value is 5."
        },
        {
            "Parameters": "-exp exp-value",
            "Info": "Specifies an EXP value of the MPLS Echo Request packet to be sent.\nThe value is an integer ranging from 0 to 7. The default value is 0."
        },
        {
            "Parameters": "-h ttl-value",
            "Info": "Specifies a TTL value.\nIf the TTL value in a packet is reduced to 0 during forwarding, the router that receives the packet sends a timeout packet to the source, indicating that the destination is unreachable.\nThe value is an integer ranging from 1 to 255. The default value is 255."
        },
        {
            "Parameters": "-m interval",
            "Info": "Specifies an interval at which MPLS Echo Request packets are sent.\nAfter the ping lsp command is run, the device sends an MPLS Echo Request packet and by default waits for 2000 ms before sending the next MPLS Echo Request packet if no reply is received. You can use this parameter to set the packet sending interval as required. Setting this parameter to less than 2000 ms is not recommended on an unstable network.\nThe value is an integer that ranges from 1 to 10000, in milliseconds. The default value is 2000."
        },
        {
            "Parameters": "-s packet-size",
            "Info": "Specifies a packet payload length, excluding the IP header and UDP header.\nThe value is an integer ranging from 65 to 9600, in bytes. The default value is 100."
        },
        {
            "Parameters": "-t time-out",
            "Info": "Specifies a timeout period for waiting for an MPLS Echo Reply packet after an MPLS Echo Request packet is sent.\nThe value is an integer ranging from 0 to 65535, in milliseconds. The default value is 2000."
        },
        {
            "Parameters": "-v",
            "Info": "Specifies the verbose information.\n-"
        },
        {
            "Parameters": "-g",
            "Info": "Performs the test using MPLS fragments.\n-"
        },
        {
            "Parameters": "segment-routing",
            "Info": "Specifies an segment routing traffic engineering (SR-MPLS TE) tunnel.\n-"
        },
        {
            "Parameters": "ip destination-iphost",
            "Info": "Specifies an IPv4 address for the destination.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "mask-length",
            "Info": "Specifies the IPv4 LSP's destination mask.\nThe value is an integer ranging from 0 to 32."
        },
        {
            "Parameters": "version",
            "Info": "Specifies SR-MPLS TE tunnels with the protocol version.\n-"
        },
        {
            "Parameters": "draft2",
            "Info": "Specifies SR-MPLS TE tunnels with the protocol version being draft2.\n-"
        },
        {
            "Parameters": "remote remote-ip",
            "Info": "Specifies the IP address of the device to be detected.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "remote-fec",
            "Info": "Indicates the remote FEC type.\n-"
        },
        {
            "Parameters": "ldp remoteipaddr",
            "Info": "Specifies the IP address of a remote LDP FEC.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "remotemasklen",
            "Info": "Specifies the mask length for the IP address of a remote LDP FEC.\nThe value is an integer ranging from 0 to 32."
        },
        {
            "Parameters": "nil",
            "Info": "Specifies the LSP Specify Nil FEC.\n-"
        },
        {
            "Parameters": "sr-te",
            "Info": "Specifies the LSP ping type to SR-MPLS TE policy.\n-"
        },
        {
            "Parameters": "policy",
            "Info": "Specifies the LSP ping type to SR-MPLS TE policy.\n-"
        },
        {
            "Parameters": "policy-name policyname",
            "Info": "Specifies the name of a policy.\nThe value is a string of 1 to 31 case-sensitive characters. It cannot contain spaces."
        },
        {
            "Parameters": "endpoint-ip endpoint-ip",
            "Info": "Specifies the destination IPv4 address of an SR-MPLS TE policy tunnel.\nThe value is in dotted decimal notation."
        },
        {
            "Parameters": "color colorid",
            "Info": "Specifies the color ID of an SR-MPLS TE policy.\nThe value is an integer ranging from 0 to 4294967295."
        },
        {
            "Parameters": "binding-sid bsid",
            "Info": "Specifies the ID of a segment bound to an SR-MPLS TE policy.\nThe value is an integer ranging from 16 to 1048575."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> ping lsp segment-routing ip 3.3.3.9 32 version draft2",
            "LSP PING FEC: SEGMENT ROUTING IPV4 PREFIX 3.3.3.9/32 : 100  data bytes, press CTRL_C to break",
            "  Reply from 3.3.3.9: bytes=100 Sequence=1 time=13 ms",
            "  Reply from 3.3.3.9: bytes=100 Sequence=2 time=9 ms",
            "  Reply from 3.3.3.9: bytes=100 Sequence=3 time=2 ms",
            "  Reply from 3.3.3.9: bytes=100 Sequence=4 time=3 ms",
            "  Reply from 3.3.3.9: bytes=100 Sequence=5 time=6 ms",
            "--- FEC: SEGMENT ROUTING IPV4 PREFIX 3.3.3.9/32 ping statistics ---",
            "  5 packet(s) transmitted",
            "  5 packet(s) received",
            "  0.00% packet loss",
            "  round-trip min/avg/max = 2/6/13 ms"
        ],
        [
            "<HUAWEI> ping lsp sr-te policy policy-name test",
            "LSP PING FEC:  Nil FEC  : 100 data bytes, press CTRL_C to break",
            "sr-te policy's segment list:",
            "Preference : 300; Path Type: main; Protocol-Origin : local; Originator: 0, 0.0.0.0; Discriminator: 300; Segment-List ID : 1;  Xcindex : 1",
            "Reply from 3.3.3.9: bytes=100 Sequence=1 time=13 ms     Reply from 3.3.3.9: bytes=100 Sequence=2 time=9 ms    ",
            "Reply from 3.3.3.9: bytes=100 Sequence=3 time=2 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=4 time=3 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=5 time=6 ms   ",
            "--- FEC: Nil FEC ping statistics ---",
            "5 packet(s) transmitted     ",
            "5 packet(s) received     ",
            "0.00% packet loss     ",
            "round-trip min/avg/max = 2/6/13 ms",
            "sr-te policy's segment list:",
            "Preference : 400; Path Type: backup; Protocol-Origin : local; Originator: 0, 0.0.0.0; Discriminator: 400; Segment-List ID : 2;  Xcindex : 2     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=1 time=13 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=2 time=9 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=3 time=2 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=4 time=3 ms     ",
            "Reply from 3.3.3.9: bytes=100 Sequence=5 time=6 ms   ",
            "--- FEC: Nil FEC ping statistics --- ",
            "5 packet(s) transmitted     ",
            "5 packet(s) received     0.00% packet loss"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nThe ping lsp command can be used to check the connectivity of LSPs on an MPLS network, and the tracert lsp command can be used to locate the faulty node.\nThe ping lsp command uses MPLS Echo Request packets and MPLS Echo Reply packets to detect the connectivity of LSPs. Both Echo Request and Echo Reply packets are transmitted in the format of UDP packets with the port number being 3503. The receiver distinguishes these two types of packets from other packets based on the port number. An MPLS Echo Request packet carries FEC information to be detected, and is sent along the same LSP as other packets carrying the same FEC information. In this manner, the connectivity of the LSP is checked. Echo Request packets are transmitted to the destination using MPLS, whereas MPLS Echo Reply packets are transmitted to the source using IP.\nThe ping lsp command can be used to check links of the following types:\nSR-MPLS BE IPv4 ping: To test the connectivity of an SR-MPLS BE IPv4 tunnel, run the ping lsp [ -a source-ip | -c count | -exp exp-value | -h ttl-value | -m interval | -s packet-size | -t time-out | -v | -g ] * segment-routing ip destination-address mask-length version draft2 [ remote remote-ip ] command.SR-MPLS BE tunnel connected with an LDP LSP tracert: To test the connectivity of an SR-MPLS BE tunnel connected with an LDP LSP, run the ping lsp [ -a source-ip | -c count | -exp exp-value | -h ttl-value | -m interval | -s packet-size | -t time-out | -v | -g ] * segment-routing ip destination-address mask-length version draft2 remote remote-ip command on the ingress to initiate a ping test to the egress with the destination address being the LDP LSP.\nWhen testing the connectivity of an SR-MPLS BE tunnel connected with an LDP LSP, specify a remote IP address using the remote remote-ip parameter.\nSR-MPLS BE tunnel connected with an LDP LSP ping: If the LDP side does not support interworking, to test the connectivity of an SR-MPLS BE tunnel connected with an LDP LSP, run the ping lsp [ -a source-ip | -c count | -exp exp-value | -h ttl-value | -m interval | -s packet-size | -t time-out | -v | -g ] * segment-routing ip destination-address mask-length version draft2 remote-fec { ldp remoteipaddr remotemasklen | nil } command on the ingress to initiate a ping test to the egress with the destination address being the LDP LSP.SR-MPLS TE policy LSP ping: If the type of tunnels to be tested is SR-MPLS TE policy, to test the connectivity of a manually configured SR-MPLS TE policy tunnel, run the ping lsp [ -a source-ip | -c count | -exp exp-value | -h ttl-value | -m interval | -s packet-size | -t time-out | -v | -g ] * sr-te policy { policy-name policyname | endpoint-ip endpoint-ip color colorid | binding-sid bsid } command to initiate a ping test to the egress.\n\nPrerequisites\nBefore using the ping lsp command, ensure that the MPLS module works properly.\nConfiguration Impact\nTo prevent the egress from forwarding a received MPLS Echo Request packet to other nodes, you can set the destination address in the IP header of the packet to 127.0.0.1/8 (the local loopback address) and the TTL value to 1.During the SR-MPLS TE Policy Ping detection, if the list in the policy changes during the ping operation, the ping cannot detect the change. You are advised to use the Ctrl+C to stop the ping and re-initiate the detection.The SR-MPLS TE Policy Ping command is used to check the connectivity of all lists of a policy."
}