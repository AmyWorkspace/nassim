{
    "PageTitle": "protocol (Board-level management service plane defense view)",
    "FuncDef": "The protocol command configures a rule to accept or discard packets of a specified protocol or all protocols before the packets are sent to the CPU.\nThe undo protocol command deletes a configured rule.\nBy default, no rule is not configured.",
    "CLIs": [
        "protocol { { ipv6 { bgp4plus | ftp | ospfv3 | ssh | telnet | pimsm } } | { bgp | ftp | ldp | ospf | rip | rsvp | snmp | ssh | telnet | tftp | isis | pimsm } } { deny | permit }",
        "undo protocol { { ipv6 { bgp4plus | ftp | ospfv3 | ssh | telnet | pimsm } } | { bgp | ftp | ldp | ospf | rip | rsvp | snmp | ssh | telnet | tftp | isis | pimsm } }"
    ],
    "ParentView": [
        "Board-level management service plane defense view"
    ],
    "ParaDef": [
        {
            "Parameters": "ipv6",
            "Info": "Configures a rule for IPv6 packets.\n-"
        },
        {
            "Parameters": "bgp4plus",
            "Info": "Configures a rule for BGP4+ packets.\n-"
        },
        {
            "Parameters": "ftp",
            "Info": "Configures a rule for FTP packets.\n-"
        },
        {
            "Parameters": "ospfv3",
            "Info": "Configures a rule for OSPFv3 packets.\n-"
        },
        {
            "Parameters": "ssh",
            "Info": "Configures a rule for SSH packets.\n-"
        },
        {
            "Parameters": "telnet",
            "Info": "Configures a rule for Telnet packets.\n-"
        },
        {
            "Parameters": "pimsm",
            "Info": "Configures a rule for PIM-SM packets.\n-"
        },
        {
            "Parameters": "bgp",
            "Info": "Configures a rule for BGP packets.\n-"
        },
        {
            "Parameters": "ldp",
            "Info": "Configures a rule for LDP packets.\n-"
        },
        {
            "Parameters": "ospf",
            "Info": "Configures a rule for OSPF packets.\n-"
        },
        {
            "Parameters": "rip",
            "Info": "Configures a rule for RIP packets.\n-"
        },
        {
            "Parameters": "rsvp",
            "Info": "Configures a rule for RSVP packets.\n-"
        },
        {
            "Parameters": "snmp",
            "Info": "Configures a rule for SNMP packets.\n-"
        },
        {
            "Parameters": "tftp",
            "Info": "Configures a rule for TFTP packets.\n-"
        },
        {
            "Parameters": "isis",
            "Info": "Configures a rule for IS-IS packets.\n-"
        },
        {
            "Parameters": "deny",
            "Info": "Discards packets.\n-"
        },
        {
            "Parameters": "permit",
            "Info": "Allows packets to be sent to the CPU.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] ma-defend slot-policy 1",
            "[*HUAWEI-app-sec-slot-1] protocol telnet deny",
            "[*HUAWEI-app-sec-slot-1] quit",
            "[*HUAWEI] slot 1",
            "[*HUAWEI-slot-1] ma-defend-slot 1"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nTo help the Router defend against attacks or unauthorized logins initiated by sending protocol packets, management and service plane protection is used to prevent packets of a specified protocol or all protocols from being sent to the CPU. Using management and service plane protection improves device security and reliability and ensures normal network operation.\nThe protocol command is run in the board-based policy view to configure a rule. The rule is used to accept or discard packets of a specified protocol or all protocols before the packets are sent to the CPU.\nPrerequisites\nA policy has been created. A board-based policy can be created as needed.\nConfiguration Impact\nAfter the protocol command is run, the device will send packets to the CPU or discard them based on specified protocols after receiving the packets.\nAfter a discard policy is configured for a specified protocol, protocol disconnections or user login failures may occur.\nPrecautions\nIf no rule is configured for a policy, management and service plane protection or its policy does not take effect.\nIn VS mode, this command is supported only by the admin VS."
}