{
    "PageTitle": "rule (service-sec6-policy view)",
    "FuncDef": "The rule command adds a rule for an MPAC policy in the service6-sec view.\nThe undo rule command deletes a rule or part of the rule configuration from an MPAC policy in the service6-sec view.\nBy default, no rule is configured for an MPAC policy in the service6-sec view.",
    "CLIs": [
        "rule [ <rule-id> ] [ name <rule-name> ] { permit | deny } protocol { ospf | rsvp | pim | ip | <ip-protocol-number-18-255> | <ip-protocol-number-1-5> | <ip-protocol-number-7-16> } [ [ source-ip { <source-ipv6-address> { <source-ipv6-prefix-length> } | <source-ipv6-address-with-prefix> | any } ] | [ destination-ip { <destination-ipv6-address> { <destination-ipv6-prefix-length> } | <destination-ipv6-address-with-prefix> | any } ] ] *",
        "rule [ <rule-id> ] [ name <rule-name> ] { permit | deny } protocol { bgp | dhcp-c | dhcp-r | ftp | ssh | telnet | lsp-ping | ntp | rip | snmp | tftp | ldp } [ [ source-ip { <source-ipv6-address> { <source-ipv6-prefix-length> } | <source-ipv6-address-with-prefix> | any } ] | [ destination-ip { <destination-ipv6-address> { <destination-ipv6-prefix-length> } | <destination-ipv6-address-with-prefix> | any } ] ] *",
        "rule [ <rule-id> ] [ name <rule-name> ] { permit | deny } protocol { tcp | udp | <tcp-protocol-number> | <udp-protocol-number> } [ [ source-port <source-port-number> ] | [ destination-port <destination-port-number> ] | [ source-ip { <source-ipv6-address> { <source-ipv6-prefix-length> } | <source-ipv6-address-with-prefix> | any } ] | [ destination-ip { <destination-ipv6-address> { <destination-ipv6-prefix-length> } | <destination-ipv6-address-with-prefix> | any } ] ] *",
        "rule [ <rule-id> ] [ name <rule-name> ] { permit | deny } protocol any",
        "rule [ <rule-id> ] [ name <rule-name> ] { permit | deny } ipv6-ext-header source-routing-type srh",
        "undo rule { <rule-id> | name <rule-name> } [ [ source-port ] | [ destination-port ] | [ source-ip ] | [ destination-ip ] ] *"
    ],
    "ParentView": [
        "Service6-sec-policy view"
    ],
    "ParaDef": [
        {
            "Parameters": "rule-id",
            "Info": "Specifies the ID of a rule for an MPAC policy.\nThe value is an integer ranging from 0 to 4294967294."
        },
        {
            "Parameters": "name rule-name",
            "Info": "Specifies the name of a rule for a Management Plane Access Control (MPAC) policy.\nThe value is a string."
        },
        {
            "Parameters": "permit",
            "Info": "Allows the matched packets to be sent to the CPU.\n-"
        },
        {
            "Parameters": "deny",
            "Info": "Prevents the matched packets from being sent to the CPU.\n-"
        },
        {
            "Parameters": "protocol",
            "Info": "Indicates the protocol name or number.\n-"
        },
        {
            "Parameters": "protocol any",
            "Info": "Indicates any protocol.\n-"
        },
        {
            "Parameters": "ospf",
            "Info": "Indicates OSPF.\n-"
        },
        {
            "Parameters": "rsvp",
            "Info": "Indicates Resource Reservation Protocol (RSVP).\n-"
        },
        {
            "Parameters": "pim",
            "Info": "Indicates PIM.\n-"
        },
        {
            "Parameters": "ip",
            "Info": "Indicates IP.\n-"
        },
        {
            "Parameters": "ip-protocol-number-1-5 ip-protocol-number-7-16 ip-protocol-number-18-255",
            "Info": "Specifies a protocol number except tcp and udp protocol number.\nIf the protocol number is 58, the protocol packets matching ICMPv6 are matched. MPAC Policy control is not performed on ND protocol packets in the ICMPv6.\nThe value is an integer ranging from 1 to 255 except 6 and 17."
        },
        {
            "Parameters": "source-ip",
            "Info": "Indicates the source IP address of packets.\n-"
        },
        {
            "Parameters": "source-ipv6-address",
            "Info": "Specifies a source IPv6 address.\nThe value is a 32-digit hexadecimal number, in the format of X:X:X:X:X:X:X:X."
        },
        {
            "Parameters": "source-ipv6-prefix-length",
            "Info": "Specifies the prefix length of a source IPv6 address.\nThe value is an integer ranging from 1 to 128."
        },
        {
            "Parameters": "any",
            "Info": "Indicates any IP address.\n-"
        },
        {
            "Parameters": "destination-ip",
            "Info": "Specifies the destination address of packets.\n-"
        },
        {
            "Parameters": "destination-ipv6-address",
            "Info": "Specifies a destination IPv6 address.\nThe value is a 32-digit hexadecimal number, in the format of X:X:X:X:X:X:X:X."
        },
        {
            "Parameters": "destination-ipv6-prefix-length",
            "Info": "Specifies the prefix length of a destination IPv6 address.\nThe value is an integer ranging from 1 to 128."
        },
        {
            "Parameters": "bgp",
            "Info": "Indicates BGP.\n-"
        },
        {
            "Parameters": "dhcp-c",
            "Info": "Indicates Dynamic Host Configuration Protocol-C (DHCP-C).\n-"
        },
        {
            "Parameters": "dhcp-r",
            "Info": "Indicates Dynamic Host Configuration Protocol-R (DHCP-R).\n-"
        },
        {
            "Parameters": "ftp",
            "Info": "Indicates FTP.\n-"
        },
        {
            "Parameters": "ssh",
            "Info": "Indicates SSH.\n-"
        },
        {
            "Parameters": "telnet",
            "Info": "Indicates Telnet.\n-"
        },
        {
            "Parameters": "lsp-ping",
            "Info": "Indicates LSP ping.\n-"
        },
        {
            "Parameters": "ntp",
            "Info": "Indicates NTP.\n-"
        },
        {
            "Parameters": "rip",
            "Info": "Indicates RIP.\n-"
        },
        {
            "Parameters": "snmp",
            "Info": "Indicates SNMP.\n-"
        },
        {
            "Parameters": "tftp",
            "Info": "Indicates TFTP.\n-"
        },
        {
            "Parameters": "ldp",
            "Info": "Indicates LDP.\n-"
        },
        {
            "Parameters": "tcp",
            "Info": "Indicates TCP.\n-"
        },
        {
            "Parameters": "udp",
            "Info": "Indicates User Datagram Protocol (UDP).\n-"
        },
        {
            "Parameters": "tcp-protocol-number",
            "Info": "Indicates TCP protocol number.\nThe value is 6."
        },
        {
            "Parameters": "udp-protocol-number",
            "Info": "Indicates UDP protocol number.\nThe value is 17."
        },
        {
            "Parameters": "source-port source-port-number",
            "Info": "Specifies the source port number.\nThe value is an integer ranging from 0 to 65535."
        },
        {
            "Parameters": "destination-port destination-port-number",
            "Info": "Specifies the destination port number.\nThe value is an integer ranging from 0 to 65535."
        },
        {
            "Parameters": "ipv6-ext-header",
            "Info": "Specifies the IPv6 extension header.\n-"
        },
        {
            "Parameters": "source-routing-type srh",
            "Info": "Specifies the SRH-type routing extension header.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] service-security policy ipv6 test",
            "[*HUAWEI-service6-sec-test] rule permit ipv6-ext-header source-routing-type srh"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nTo match specific users or packets, run the rule command to specify the protocol name, 5-tuple or IPv6 extension header matching rule. Currently, only SRH-type routing extension header is supported.\nPrecautions\nAn IS-IS-based rule cannot be configured in the service6-sec policy view.\nExercise caution when using the rule [ rule-id ] deny protocol any command. After this command is applied globally, no protocol packets are sent to the CPU, causing the device to be out of management."
}