{
    "PageTitle": "capture-packet local-host",
    "FuncDef": "The capture-packet local-host command configures the function of obtaining host packet headers sent to CPUs.\nThe undo capture-packet command deletes a specified obtaining host packet headers instance.\nBy default, devices do not obtain host packet headers sent to their CPUs.",
    "CLIs": [
        "capture-packet local-host { all | arp | bfd | dhcp | dns-client | vgmp | ftp-client | ftp-server | hwtacacs | icmp | igmp | isis | lacp | ldp | lspping | msdp | ntp | ospf | pim | radius | rip | rsvp | snmp | ssh-client | ssh-server | sftp-server | telnet-client | telnet-server | tftp | bgp | sftp-client | rrpp | vrrp | mplsoam | esmc | ieee-8021ag | eapol | tcpsyn | <sysid> } { interface { <interface-type> <interface-number> | <interface-name> } [ vlan <vlanBeginValue> [ to <vlanEndValue> ] | pvlan <peBeginValue> [ to <peEndValue> ] cvlan <ceBeginValue> [ to <ceEndValue> ] ] | linktype { ethernet | ppp | hdlc } } [ [ ipv6 ] acl { <aclNumber> | name <aclName> } ] [ [ time-out <timeValue> ] | [ packet-num <numberValue> ] | [ packet-len <lengthValue> ] | overwrite | [ buffer-only | { file <filename> [ <filesize> ] } ] ] *",
        "undo capture-packet local-host { all | arp | bfd | dhcp | dns-client | vgmp | ftp-client | ftp-server | hwtacacs | icmp | igmp | isis | lacp | ldp | lspping | msdp | ntp | ospf | pim | radius | rip | rsvp | snmp | ssh-client | ssh-server | sftp-server | telnet-client | telnet-server | tftp | bgp | sftp-client | rrpp | vrrp | mplsoam | esmc | ieee-8021ag | eapol | tcpsyn | <sysid> } { interface { <interface-type> <interface-number> | <interface-name> } [ vlan <vlanBeginValue> [ to <vlanEndValue> ] | pvlan <peBeginValue> [ to <peEndValue> ] cvlan <ceBeginValue> [ to <ceEndValue> ] ] | linktype { ethernet | ppp | hdlc } } [ [ ipv6 ] acl { <aclNumber> | name <aclName> } ]"
    ],
    "ParentView": [
        "User view"
    ],
    "ParaDef": [
        {
            "Parameters": "all",
            "Info": "Obtains all packet headers that are destined for the local address.\n-"
        },
        {
            "Parameters": "arp",
            "Info": "Obtains ARP packet headers.\n-"
        },
        {
            "Parameters": "bfd",
            "Info": "Obtains BFD packet headers.\n-"
        },
        {
            "Parameters": "dhcp",
            "Info": "Obtains DHCP packet headers.\n-"
        },
        {
            "Parameters": "dns-client",
            "Info": "Obtains packet headers sent by DNS clients.\n-"
        },
        {
            "Parameters": "vgmp",
            "Info": "Obtains VGMP packet headers.\n-"
        },
        {
            "Parameters": "ftp-client",
            "Info": "Obtains packet headers sent by FTP clients.\n-"
        },
        {
            "Parameters": "ftp-server",
            "Info": "Obtains packet headers sent by the FTP server.\n-"
        },
        {
            "Parameters": "hwtacacs",
            "Info": "Obtains HWTACACS packet headers.\n-"
        },
        {
            "Parameters": "icmp",
            "Info": "Obtains ICMP packet headers.\n-"
        },
        {
            "Parameters": "igmp",
            "Info": "Obtains IGMP packet headers.\n-"
        },
        {
            "Parameters": "isis",
            "Info": "Obtains IS-IS packet headers.\n-"
        },
        {
            "Parameters": "lacp",
            "Info": "Obtains LACP packet headers.\n-"
        },
        {
            "Parameters": "ldp",
            "Info": "Obtains LDP packet headers.\n-"
        },
        {
            "Parameters": "lspping",
            "Info": "Obtains LSP ping packet headers.\n-"
        },
        {
            "Parameters": "msdp",
            "Info": "Obtains MSDP packet headers.\n-"
        },
        {
            "Parameters": "ntp",
            "Info": "Obtains NTP packet headers.\n-"
        },
        {
            "Parameters": "ospf",
            "Info": "Obtains OSPF packet headers.\n-"
        },
        {
            "Parameters": "pim",
            "Info": "Obtains PIM packet headers.\n-"
        },
        {
            "Parameters": "radius",
            "Info": "Obtains RADIUS packet headers.\n-"
        },
        {
            "Parameters": "rip",
            "Info": "Obtains RIP packet headers.\n-"
        },
        {
            "Parameters": "rsvp",
            "Info": "Obtains RSVP packet headers.\n-"
        },
        {
            "Parameters": "snmp",
            "Info": "Obtains SNMP packet headers.\n-"
        },
        {
            "Parameters": "ssh-client",
            "Info": "Obtains packet headers sent by SSH clients.\n-"
        },
        {
            "Parameters": "ssh-server",
            "Info": "Obtains packet headers sent by the SSH server.\n-"
        },
        {
            "Parameters": "sftp-server",
            "Info": "Obtains packet headers sent by the SFTP server.\n-"
        },
        {
            "Parameters": "telnet-client",
            "Info": "Obtains packet headers sent by Telnet clients.\n-"
        },
        {
            "Parameters": "telnet-server",
            "Info": "Obtains packet headers sent by the Telnet server.\n-"
        },
        {
            "Parameters": "tftp",
            "Info": "Obtains TFTP packet headers.\n-"
        },
        {
            "Parameters": "bgp",
            "Info": "Obtains BGP packet headers.\n-"
        },
        {
            "Parameters": "sftp-client",
            "Info": "Obtains packet headers sent by SFTP clients.\n-"
        },
        {
            "Parameters": "rrpp",
            "Info": "Obtains RRPP packet headers.\n-"
        },
        {
            "Parameters": "vrrp",
            "Info": "Obtains VRRP packet headers.\n-"
        },
        {
            "Parameters": "mplsoam",
            "Info": "Obtains MPLS OAM packet headers.\n-"
        },
        {
            "Parameters": "ieee-8021ag",
            "Info": "Obtains 802.1ag packet headers.\n-"
        },
        {
            "Parameters": "eapol",
            "Info": "Obtains EAPOL packet headers.\n-"
        },
        {
            "Parameters": "tcpsyn",
            "Info": "Obtains TCPSYN packet headers.\n-"
        },
        {
            "Parameters": "sysid",
            "Info": "Obtains packet headers of a protocol with a specified protocol ID.\nThe value is an integer ranging from 0 to 1658."
        },
        {
            "Parameters": "interface interface-type interface-number",
            "Info": "Type and number of an interface.\n-"
        },
        {
            "Parameters": "linktype",
            "Info": "Indicates data link layer protocols.\nData link layer protocols include:\nethernetppphdlc"
        },
        {
            "Parameters": "ipv6",
            "Info": "Indicates the IPv6 ACL.\n-"
        },
        {
            "Parameters": "acl aclNumber",
            "Info": "ACL number.\nThe value is an integer ranging from 2000 to 4999."
        },
        {
            "Parameters": "name aclName",
            "Info": "ACL name.\nThe value is a string of 1 to 64 case-sensitive characters without spaces. The value must start with a letter (a to z or A to Z, case sensitive)."
        },
        {
            "Parameters": "time-out timeValue",
            "Info": "Timeout time.\nThe value is an integer ranging from 1 to 86400, in seconds. The default value is 15."
        },
        {
            "Parameters": "packet-num numberValue",
            "Info": "Number of packet headers to be obtained for an instance.\nThe value is an integer ranging from 1 to 6000. The default value is 10."
        },
        {
            "Parameters": "packet-len lengthValue",
            "Info": "Length of a packet to be obtained.\nThe value is an integer ranging from 20 to 64, in bytes. The default value is 20."
        },
        {
            "Parameters": "overwrite",
            "Info": "Sets the overwrite function. When the number of obtained packet headers reaches the configured upper limit, an instance continues obtaining packets. Newly obtained packet headers overwrite the most previously obtained packet headers. Packet head getting stops when the stop time arrives or is manually terminated by a command.\n-"
        },
        {
            "Parameters": "buffer-only",
            "Info": "Indicates that a file (packet head getting file) that contains information about obtained packet headers is saved only to the main control board's memory. By default, the file is saved to the main control board's memory or CF card.\n-"
        },
        {
            "Parameters": "file filename",
            "Info": "Name of the file of obtaining packet headers.\nThe string carrying \"/\" is not supported in the file name.\nThe value is a string of 5 to 64 case-sensitive characters without spaces. The file name extension must be .cap."
        },
        {
            "Parameters": "filesize",
            "Info": "Size of the file of obtaining packet headers .\nThe value is an integer ranging from 1 to 10, in M. The default value is 2."
        },
        {
            "Parameters": "esmc",
            "Info": "Obtains ESMC packet headers.\n-"
        },
        {
            "Parameters": "vlan vlanBeginValue to vlanEndValue",
            "Info": "Specifies a VLAN range.\nvlanbeginvalue: specifies the start VLAN ID.vlanendvalue: specifies the end VLAN ID.vlanendvalue must be greater than vlanbeginvalue. vlanbeginvalue and vlanendvalue define a range together.\nIf the parameter to vlanendvalue is not specified, only the VLAN specified by vlanbeginvalue is created.\nThe value is an integer ranging from 1 to 4094."
        },
        {
            "Parameters": "pvlan peBeginValue to peEndValue",
            "Info": "Specifies an outer VLAN range.\npebeginvalue: specifies the start VLAN ID.peendvalue: specifies the end VLAN ID.peendvalue must be greater than pebeginvalue. pebeginvalue and peendvalue define a range together.\nIf the parameter to peendvalue is not specified, only the VLAN specified by pebeginvalue is created.\nThe value is an integer ranging from 1 to 4094."
        },
        {
            "Parameters": "cvlan ceBeginValue to ceEndValue",
            "Info": "Specifies an inner VLAN range.\ncebeginvalue: specifies the start VLAN ID.ceendvalue: specifies the end VLAN ID.ceendvalue must be greater than cebeginvalue. cebeginvalue and ceendvalue define a range together.\nIf the parameter to ceendvalue is not specified, only the VLAN specified by cebeginvalue is created.\nThe value is an integer ranging from 1 to 4094."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> capture-packet local-host all interface GigabitEthernet1/0/0"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nWhen a host receives a large number of packet headers, its CPU usage becomes high. You can obtain packet headers sent to this host's CPU for analysis and take control actions. You can obtain packet headers sent to a CPU for an interface or a VLAN. You can also configure an ACL rule to obtain packet headers sent to a CPU.\nThe packet header obtaining file must be in PCAP format. The default file name is capture_host_protocol type or SysID_Time (yyyy-mm-dd-hh-mm-ss), for example, capture_host_all_2012-03-31-06-09-09.cap.\nAfter you run the capture-packet local-host command, the device obtains a packet header obtaining instance, which is identified by a packet header obtaining instance index. Each packet header obtaining instance is saved as a packet header obtaining file. This file contains obtained packet headers. The size of each packet header obtaining file is 2 MB.\nObtaining packet headers sent to CPUs is related to the factors, such as the timeout time specified by time, number of obtained packet headers specified by number, and number of packet header obtaining instances. If any of the factors is met, packet header obtaining stops.\nPrerequisites\nThe main control board has sufficient space for storing the files of obtained packet headers if packet header information needs to be saved to packet header obtaining files.\nConfiguration Impact\nObtaining packet headers sent to CPUs has no impact on system performance.\nPrecautions\nThe limitations on packet header obtaining instances are as follows:\nA device supports a maximum of eight packet header obtaining instances. If the number of packet header obtaining instances saved in the main control board's memory exceeds eight, you cannot configure a new packet header obtaining instance.The size of each packet header obtaining file is 2 MB and cannot be changed. If the remaining storage space is less than 2 MB, the device does not save packet header obtaining information."
}