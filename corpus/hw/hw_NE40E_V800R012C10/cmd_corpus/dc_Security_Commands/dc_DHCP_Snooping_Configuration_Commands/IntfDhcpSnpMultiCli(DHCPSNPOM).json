{
    "PageTitle": "dhcp check chaddr enable",
    "FuncDef": "The dhcp snooping check enable command enables DHCP check.\nThe undo dhcp snooping check enable command disables DHCP check.\nThe dhcp snooping alarm threshold command configures an alarm threshold for the number of dropped ARP packets, IP packets, DHCP reply packets (received on the untrusted interface), and DHCP request packets in a VLAN. In addition, you can configure the percentage threshold for the maximum number of DHCP snooping users.\nThe undo dhcp snooping alarm threshold command restores the default setting.\nThe dhcp check chaddr enable command enables CHADDR field check for the VLAN.\nThe undo dhcp check chaddr enable command disables CHADDR field check for the VLAN.\n\nBy default:\n\n\nThe function of DHCP check is disabled.\n\nThe alarm threshold for the number of dropped packets in a VLAN is a global alarm threshold (which is 100 by default and can be configured manually).\n\nThe percentage threshold for the maximum number of DHCP snooping users in a VLAN is 100%.",
    "CLIs": [
        "dhcp { { snooping check { dhcp-request | arp | ip } } enable | snooping alarm { { dhcp-chaddr | dhcp-request | dhcp-reply | arp | ip } { enable | threshold <threshold-value> } | user-limit { enable | threshold <threshold-value> } } }",
        "dhcp check chaddr enable",
        "undo dhcp { { snooping check { dhcp-request | arp | ip } } enable | snooping alarm { dhcp-chaddr | dhcp-request | dhcp-reply | arp | ip | user-limit } { enable | threshold } }",
        "undo dhcp check chaddr enable"
    ],
    "ParentView": [
        "100GE interface view",
        "10GE interface view",
        "40GE interface view",
        "Eth-Trunk interface view",
        "GE optical interface view",
        "GE electrical interface view",
        "Sub-interface view"
    ],
    "ParaDef": [
        {
            "Parameters": "dhcp-request",
            "Info": "(dhcp-request that follows snooping alarm),indicates the alarm threshold for the number of dropped DHCP request packets that mismatch any entry in the bind table.\n-"
        },
        {
            "Parameters": "dhcp-request",
            "Info": "(dhcp-request that follows snooping check),indicates that DHCP request packets are matched against the binding table.\n-"
        },
        {
            "Parameters": "arp",
            "Info": "(arp that follows snooping alarm),indicates the alarm threshold for the number of dropped ARP packets that mismatch any entry in the bind table.\n-"
        },
        {
            "Parameters": "arp",
            "Info": "(arp that follows snooping check),indicates that ARP packets are matched against the binding table.\n-"
        },
        {
            "Parameters": "ip",
            "Info": "(ip that follows snooping alarm),indicates the alarm threshold for the number of dropped IP packets that mismatch any entry in the binding table.\n-"
        },
        {
            "Parameters": "ip",
            "Info": "(ip that follows snooping check),indicates that IP packets are matched against the binding table.\n-"
        },
        {
            "Parameters": "dhcp-chaddr",
            "Info": "Indicates the alarm threshold for the number of dropped DHCP packets with the client hardware address (CHADDR) field value mismatching the source MAC address in the Ethernet frame header.\n-"
        },
        {
            "Parameters": "dhcp-reply",
            "Info": "Indicates the alarm threshold for the number of dropped DHCP reply packets on an untrusted interface.\n-"
        },
        {
            "Parameters": "threshold threshold-value",
            "Info": "Specifies an alarm threshold.\nThe alarm threshold for the maximum number of dropped packets in a VLAN ranges from 1 to 1000. The default value is 100. The percentage threshold for the maximum number of DHCP snooping users ranges from 1 to 100%. The default value is 100%."
        },
        {
            "Parameters": "user-limit",
            "Info": "Indicates the percentage threshold for the maximum number of DHCP snooping users.\n-"
        },
        {
            "Parameters": "chaddr",
            "Info": "Indicates that the client hardware address (CHADDR) field value is matched against the MAC address in the Ethernet frame header.\n-"
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] dhcp snooping enable",
            "[*HUAWEI] interface GigabitEthernet 4/0/1",
            "[*HUAWEI-GigabitEthernet4/0/1] dhcp snooping enable",
            "[*HUAWEI-GigabitEthernet4/0/1] dhcp snooping max-user-number 3000",
            "[*HUAWEI-GigabitEthernet4/0/1] dhcp snooping alarm user-limit enable",
            "[*HUAWEI-GigabitEthernet4/0/1] dhcp snooping alarm user-limit threshold 50"
        ],
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] dhcp snooping enable",
            "[*HUAWEI] interface GigabitEthernet 4/0/0",
            "[*HUAWEI-GigabitEthernet4/0/0] dhcp snooping enable",
            "[*HUAWEI-GigabitEthernet4/0/0] dhcp check chaddr enable"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nYou can configure the following check functions in DHCP snooping applications:\nWhen the man-in-the-middle attack or IP/MAC address spoofing occurs, you can configure ARP or IP check to determine whether the source IP and MAC addresses in the ARP or IP packets match those in the DHCP snooping binding table.To enable the device to protect against DHCP exhaustion attacks, configure the device to check whether a received DHCP request packet or DHCP release packet matches an entry in the DHCP snooping binding table.After receiving a DHCP request packet:\nThe device checks whether the source MAC address is all Fs. If the source MAC address is all Fs, the device allows the packet to pass. If the source MAC address is not all Fs, the device considers the packet a packet for extending the IP address lease and checks whether the packet matches an entry in the DHCP snooping binding table.The device checks whether the CHADDR field in the packet matches an entry in the DHCP snooping binding table. If no matching entry exists, the device allows the packet to pass. If a matching entry exists, the device checks whether the VLAN ID, IP address, and interface information in the packet match an entry in the DHCP snooping binding table. If a matching entry exists, the device allows the packets to pass. If no matching entry exists, the device discards the packet.\nAfter receiving a DHCP release packet, the device checks whether the VLAN ID, IP address, MAC address, and interface information in the packet match an entry in the DHCP snooping binding table. If a matching entry exists, the device allows the packet to pass. If no matching entry exists, the device discards the packet.\nTo configure the alarm function for the number of dropped packets and restrict the maximum number of users, run the dhcp snooping alarm threshold command.\nThe configuration of the alarm threshold for dropped packets in a VLAN can be one of the following situations:\nIf no alarm threshold is configured for the VLAN, the globally configured default value is used as the alarm threshold of the VLAN. You can change the default value by configuring an alarm threshold globally.If an alarm threshold is configured for a VLAN, the configured threshold takes effect.\n\nPrerequisites\nDHCP snooping has been enabled globally using the dhcp snooping enable command.\nThe alarm function has been enabled using the dhcp snooping alarm enable command.\nThe maximum number of users has been configured using the dhcp snooping max-user-number (interface view) command.\n\nPrecautions\nIf the maximum number of DHCP snooping users is set to n and the percentage threshold for the maximum number of DHCP snooping users is set to m, when the number of users in the VLAN reaches nxm, an alarm is generated. When the number of users in the VLAN reaches nxm+1, however, no more alarm is generated. Only when the user lease expires or users proactively release IP addresses, the number of users in the VLAN falls below nxm. When the number of users reaches nxm again, an alarm is generated.\nYou can change the current percentage threshold by configuring a new value. Only the current setting takes effect."
}