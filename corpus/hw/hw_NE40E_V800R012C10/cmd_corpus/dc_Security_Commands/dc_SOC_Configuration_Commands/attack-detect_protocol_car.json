{
    "PageTitle": "attack-detect protocol car",
    "FuncDef": "The attack-detect protocol car command sets the rate threshold for sending protocol packets to the CPU and the packet loss percentage threshold for attack detection.\nThe undo attack-detect protocol car command restores the default rate threshold for sending protocol packets to the CPU and packet loss percentage threshold for attack detection.\nTable 1 lists the default rate thresholds for sending protocol packets to the CPU and packet loss percentage thresholds for attack detection.",
    "CLIs": [
        "attack-detect protocol <protocol-name> car { min-rate <rate-value> | drop-packet-percent <percentage> } *",
        "undo attack-detect protocol <protocol-name> car { min-rate <rate-value> | drop-packet-percent <percentage> } *"
    ],
    "ParentView": [
        "SOC view"
    ],
    "ParaDef": [
        {
            "Parameters": "min-rate rate-value",
            "Info": "Specifies a rate threshold for CP-CAR.\nThe value is an integer ranging from 20 to 4000, in pps."
        },
        {
            "Parameters": "drop-packet-percent percentage",
            "Info": "Specifies a packet loss percentage threshold for CP-CAR.\nThe value is an integer ranging from 0 to 99, in percentage."
        },
        {
            "Parameters": "protocol protocol-name",
            "Info": "Specifies the name of a protocol that supports CAR. The value can be the name of a protocol such as 802.1ag, ARP, BFD, BGP, Telnet-client, Telnet-server, or TFTP.\nThe actual protocol may vary."
        }
    ],
    "Examples": [
        [
            "<HUAWEI> system-view",
            "[~HUAWEI] soc",
            "[*HUAWEI-soc] attack-detect protocol arp car min-rate 200",
            "Warning: The default drop-packet-percent threshold is 30, default min-rate threshold is 500.Continue? [Y/N]: Y"
        ]
    ],
    "ExtraInfo": "Usage Scenario\nThe security Operating Center (SOC) determines whether the system is being attacked based on the statistics analysis. To correctly obtain these statistics on a live network, you must set proper alarm thresholds for security attack events. The traffic models vary with different networkings in different scenarios.\nOn small-scale networks where the traffic rate is low, router bandwidth is low, and the number of users is small, setting a low alarm threshold is recommended.On large-scale networks where the traffic rate is high, router bandwidth is high, and the number of users is great, setting a high alarm threshold is recommended.\nAdditionally, you can also adjust the threshold based on the security attack event reports. If false alarms are frequently reported, you can increase the alarm threshold. However, if some security attacks are ignored (the security attacks are detected by other monitoring systems but not reported by the SOC), you can lower the alarm threshold.\nTable1 Default rate thresholds for sending protocol packets to the CPU and packet loss percentage thresholds for attack detection\n\n protocol\n\nmin-rate\n\ndrop-packet-percent\n\n\n\n  802.1ag\n\n500\n\n30\n\n\n ttl-expiredv6\n\n500\n\n30\n\n\n udp\n\n500\n\n30\n\n\n unknown\n\n500\n\n30\n\n\n vgmp\n\n500\n\n30\n\n\n vrrp\n\n500\n\n30\n\n\n web\n\n500\n\n30\n\n\n web_auth_server\n\n500\n\n30\n\n\n white-list\n\n500\n\n30\n\n\n arp\n\n500\n\n30\n\n\n arpmiss\n\n500\n\n30\n\n\n bfd\n\n500\n\n30\n\n\n bfdv6\n\n500\n\n30\n\n\n bgp\n\n500\n\n30\n\n\n bgpv6\n\n500\n\n30\n\n\n dhcp\n\n500\n\n20\n\n\n dhcpv6\n\n500\n\n30\n\n\n diameter\n\n500\n\n30\n\n\n dns-client\n\n500\n\n30\n\n\n dnsv6\n\n500\n\n30\n\n\n eapol\n\n500\n\n30\n\n\n fib-miss\n\n500\n\n30\n\n\n fib-missv6\n\n500\n\n30\n\n\n ftp-client\n\n500\n\n30\n\n\n ftp-server\n\n300\n\n30\n\n\n ftpv6-client\n\n500\n\n30\n\n\n ftpv6-server\n\n500\n\n30\n\n\n hgmp\n\n500\n\n30\n\n\n http-redirect-chasten\n\n500\n\n30\n\n\n hwtacacs\n\n500\n\n30\n\n\n icmp\n\n500\n\n30\n\n\n icmp-broadcast-address-echo\n\n500\n\n30\n\n\n icmpv6\n\n500\n\n30\n\n\n igmp\n\n500\n\n30\n\n\n ipfpm\n\n500\n\n30\n\n\n ipv6\n\n500\n\n30\n\n\n isis\n\n500\n\n30\n\n\n l2tp\n\n500\n\n30\n\n\n lacp\n\n500\n\n30\n\n\n ldp\n\n500\n\n30\n\n\n lldp\n\n500\n\n30\n\n\n lspping\n\n500\n\n30\n\n\n mka\n\n500\n\n30\n\n\n mld\n\n500\n\n20\n\n\n mpls-oam\n\n500\n\n30\n\n\n msdp\n\n500\n\n30\n\n\n multicast\n\n500\n\n30\n\n\n multicastv6\n\n500\n\n30\n\n\n na\n\n500\n\n30\n\n\n nd\n\n500\n\n30\n\n\n ns\n\n500\n\n30\n\n\n ntp\n\n500\n\n30\n\n\n openflow\n\n500\n\n30\n\n\n ospfv2\n\n500\n\n30\n\n\n ospfv3\n\n500\n\n30\n\n\n padi\n\n500\n\n30\n\n\n pim\n\n500\n\n30\n\n\n pim_mc\n\n500\n\n30\n\n\n pimv6\n\n500\n\n30\n\n\n portal\n\n500\n\n30\n\n\n pppoe\n\n500\n\n30\n\n\n ra\n\n500\n\n30\n\n\n radius\n\n500\n\n30\n\n\n rip\n\n500\n\n30\n\n\n rrpp\n\n500\n\n30\n\n\n rs\n\n500\n\n30\n\n\n rsvp\n\n500\n\n30\n\n\n sftp-client\n\n500\n\n30\n\n\n sftp-server\n\n500\n\n30\n\n\n snmp\n\n500\n\n30\n\n\n snmpv6\n\n500\n\n30\n\n\n ssh-client\n\n500\n\n30\n\n\n ssh-server\n\n500\n\n30\n\n\n sshv6-server\n\n500\n\n30\n\n\n tcp\n\n500\n\n30\n\n\n tcp-65410\n\n500\n\n30\n\n\n telnet-client\n\n500\n\n30\n\n\n telnet-server\n\n500\n\n30\n\n\n telnetv6-client\n\n500\n\n30\n\n\n telnetv6-server\n\n500\n\n30\n\n\n tftp\n\n500\n\n30\n\n\n tftpv6-client\n\n500\n\n30\n\n\n ttl-expired\n\n500\n\n30\n\n\n 802.3ah\n\n500\n\n30\n\n\n\n\n\nPrecautions\nIn VS mode, this command is supported only by the admin VS."
}